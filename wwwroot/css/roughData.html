@page
@model IndexModel
@{
    ViewData["Title"] = "Home page";
}

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>StartForm</title>
    <link rel="stylesheet" href="/css/site.css">

</head>
<body>

<div class="container-form">
        <h2 class="text-center">TOURNAMENT / MATCH</h2>
        <form action="/Scoring" method="post">
            <div class="mb-3">
                <label for="dropdown1" class="form-label">TOURNAMENT</label>
                <select class="form-select" id="dropdown1" name="TournamentId" required>
                    <option value="" selected>Select an option</option>
                    @if (Model.TournamentList != null && Model.TournamentList.Any())
                    {    
                        @foreach(var stat in Model.TournamentList)
                        {
                            <option value="@stat.idTournament">@stat.Tournament_Name</option>
                        }
                    }   
                </select>
            </div>

            <div class="mb-3">
                <label for="dropdown2" class="form-label">MATCH</label>
                <select class="form-select" id="dropdown2" name="MatchId" required>
                    <option value="" selected>Select an option</option>
                </select>
            </div>
            <div class="text-end">
            <button type="button" class="btn" data-bs-toggle="modal" data-bs-target="#exampleModal" onclick="fetchTossData()">Go For Toss</button>
            </div>
        </form>
    </div>

    <div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="exampleModalLabel" style="">TOSS</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
  <table>
    <thead>
      <tr>
        <th>Team Won Toss</th>
        <th>Attacking</th>
        <th>Defending</th>
      </tr>
    </thead>
    <tbody>

      <tr>
        <td>
                <button class="toss-button" id="HomeTeam" onclick="selectTeam('HomeTeam')">HomeTeam</button>
        </td>
        <td>
          <div class="radio-options">
            <input class="form-check-input" type="checkbox" name="homeChoice" value="Attacking" id="flexCheckDefault">
            <label for="homeAttacking">Attacking</label>
          </div>
        </td>
        <td>
          <div class="radio-options">
            <input class="form-check-input" type="checkbox" name="homeChoice"  value="Defending" id="flexCheckDefault">
            <label for="homeDefending">Defending</label>

          </div>
        </td>
      </tr>

      <tr>
        <td>
                <button class="toss-button" id="AwayTeam" onclick="selectTeam('AwayTeam')">AwayTeam</button>
        </td>
        <td>
          <div class="radio-options">
            <input class="form-check-input" type="checkbox" name="awayChoice" value="Attacking" id="awayAttacking">
            <label for="awayAttacking">Attacking</label>
          </div>
        </td>
        <td>
          <div class="radio-options">
            <input class="form-check-input" type="checkbox" name="awayChoice" value="Defending" id="awayDefending">
            <label for="awayDefending">Defending</label>
          </div>
        </td>
      </tr>

    </tbody>
  </table>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn-m" data-bs-dismiss="modal">Cancel</button>
                    <button type="button" class="btn-m" id="confirmNavigate">Start</button>
                </div>
            </div>
        </div>
    </div>


    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/js/bootstrap.bundle.min.js"></script>

<script>

document.querySelector('#dropdown1').addEventListener('change', function () {
        const tournamentId = this.value;
        const dropdown2=document.querySelector('#dropdown2');

        if (!tournamentId) {
            dropdown2.innerHTML = '<option value="" selected>Select a match</option>';
            return;
        }

        fetch(`${window.location.origin}/GetMatches?tournamentId=${tournamentId}`)
            .then(response => {
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                return response.json();
            }) 
            .then(data => {
                dropdown2.innerHTML = '<option value="" selected>Select a match</option>'; // Reset dropdown

                if (data.length > 0) {
                    data.forEach(match => {
                        const option = document.createElement('option');
                        option.value = match.id;
                        option.textContent = match.name;
                        dropdown2.appendChild(option);


                    });
                } else {
                    const option = document.createElement('option');
                    option.value = "";
                    option.textContent = "No matches found";
                    dropdown2.appendChild(option);
                }
            })
            .catch(err => {
                console.error('Error fetching matches:', err);
            });
    });


let selectedTeam = null;
let selectedChoice = null;

function getSelectedData() {
    if (!selectedTeam) {
        alert('Please select a team.');
        return null;
    }

    const homeChoice = document.querySelector('input[name="homeChoice"]:checked');
    const awayChoice = document.querySelector('input[name="awayChoice"]:checked');

    const selectedCheckbox = homeChoice
        ? { team: 'HomeTeam', choice: homeChoice.value }
        : awayChoice
        ? { team: 'AwayTeam', choice: awayChoice.value }
        : null;

    if (!selectedCheckbox) {
        alert('Please select Attacking or Defending for the chosen team.');
        return null;
    }

    let otherTeamChoice='';
    let unselectedTeam='';
    if(selectedCheckbox.team === 'HomeTeam')
    {
        otherTeamChoice=selectedCheckbox.choice === 'Attacking' ? 'Defending' : 'Attacking';
        unselectedTeam='AwayTeam';
    }
    else if(selectedCheckbox.team === 'AwayTeam')
    {
        otherTeamChoice=selectedCheckbox.choice === 'Attacking' ? 'Defending' : 'Attacking';
        unselectedTeam='HomeTeam';
    }

    return {
        team1: selectedCheckbox.team,
        team2: unselectedTeam,
        choice:selectedCheckbox.choice,
        otherTeamChoice: otherTeamChoice,

    };
}

function selectTeam(teamId) {
    if (selectedTeam && selectedTeam !== teamId) {
        document.querySelector(`#${selectedTeam}`).classList.remove('selected');
    }

    selectedTeam = teamId;
    document.querySelector(`#${teamId}`).classList.add('selected');
}


document.querySelector('#confirmNavigate').addEventListener('click', function () {
    const selectedData = getSelectedData();

    if (selectedData) {
        const tournamentId = document.querySelector('#dropdown1').value;
        const matchNo = document.querySelector('#dropdown2').value;

        if (!tournamentId || !matchNo) {
            alert('Please select Tournament and Match.');
            return;
        }

        console.log(`Selected TournamentId: ${tournamentId}, Selected MatchNo: ${matchNo}`);

        const queryString = new URLSearchParams({
            tournamentId: tournamentId,
            matchNo: matchNo,
            team1: selectedData.team1,
            team2: selectedData.team2,
            choice: selectedData.choice,
            otherTeamChoice: selectedData.otherTeamChoice
        }).toString();
        window.location.href = `/Scoring?${queryString}`;
    }
}); 


function fetchTossData(tournamentId, matchNo) {
    fetch(`${window.location.origin}/GetTossData?tournamentId=${tournamentId}&matchNo=${matchNo}`)
        .then(response => {
            if (!response.ok) {
                throw new Error(`Error fetching toss data: ${response.statusText}`);
            }
            return response.json();
        })
        .then(data => {
            const homeTeamButton = document.querySelector('#HomeTeam');
            const awayTeamButton = document.querySelector('#AwayTeam');

            if (data && data.length > 0) {
                homeTeamButton.textContent = data[0].HomeTeam || 'No data';
                awayTeamButton.textContent = data[0].AwayTeam || 'No data';

                homeTeamButton.dataset.teamId = 'winner';
                awayTeamButton.dataset.teamId = 'loosing';
            } else {
                homeTeamButton.textContent = 'No data found';
                awayTeamButton.textContent = 'No data found';
            }
        })
        .catch(err => {
            console.error('Error fetching toss data:', err);

            const homeTeamButton = document.querySelector('#HomeTeam');
            const awayTeamButton = document.querySelector('#AwayTeam');
            homeTeamButton.textContent = 'Error loading data';
            awayTeamButton.textContent = 'Error loading data';
        });
}



</script>


</body>
</html>


using Microsoft.AspNetCore.Mvc;
using Microsoft.AspNetCore.Mvc.RazorPages;
using Microsoft.EntityFrameworkCore;
using _24IN_Ultimate_KHO_KHO_VS.Data;
using Microsoft.Extensions.Logging;
using Microsoft.EntityFrameworkCore.Metadata.Internal;  // Ensure this namespace is included

public class IndexModel : PageModel
{
    private readonly ApplicationDbContext _context;
    private readonly ILogger<IndexModel> _logger;

    public IndexModel(ApplicationDbContext context, ILogger<IndexModel> logger)
    {
        _context = context; 
        _logger = logger;
    }

    public List<TournamentMaster> TournamentList { get; set; }
    public List<MatchMaster> MatchList { get; set; }
    public List<GetMatchNameTossData_Scoring> GetMatchNameTossDataScoringList{get;set;}
    public async Task OnGetAsync(string tournamentId, string matchNo)
    {
        TournamentList = await _context.TournamentMaster    
            .FromSqlInterpolated($"select idTournament,Tournament_Name from TournamentMaster")
            .ToListAsync();


        MatchList=await _context.MatchMaster
        .FromSqlInterpolated($"select idTournament,MatchNo,Match_Name from MatchMaster")
        .ToListAsync();


    }


}









    








using Microsoft.AspNetCore.Mvc;
using Microsoft.EntityFrameworkCore;
using _24IN_Ultimate_KHO_KHO_VS.Data;

    
    public class IndexController : Controller
    {
         public IActionResult Index(string tournamentId, string matchNo)
        {
            ViewBag.TournamentId = tournamentId;
            ViewBag.MatchNo = matchNo;
            return View();
        }
        private readonly ApplicationDbContext _context;
        private readonly ILogger<IndexModel> _logger;


        public IndexController(ApplicationDbContext context,ILogger<IndexModel> logger)
        {
            _context = context;
            _logger=logger;
        }

        [HttpGet("GetMatches")]
        public async Task<IActionResult> GetMatches(string tournamentId)
        {
            if (string.IsNullOrEmpty(tournamentId))
            {
                return BadRequest("Tournament ID is required.");
            }

             _logger.LogInformation($"Get Matches TournamentId: {tournamentId}");

                var matches = await _context.MatchMaster
                .Where(m => m.idTournament == tournamentId)
                .Select(m => new { id = m.MatchNo, name = m.Match_Name })
                .ToListAsync();

            if (matches == null || !matches.Any())
            {
                return Json(new { message = "No matches found" });
            }

            var result = matches.Select(m => new { id = m.id, name = m.name }).ToList();

            return Json(result);
        }

        [HttpGet("GetTossData")]
        public async Task<IActionResult> GetTossData(string tournamentId, string matchNo)
        {
            if (string.IsNullOrEmpty(tournamentId) || string.IsNullOrEmpty(matchNo))
            {
                return BadRequest("Tournament ID and Match No are required.");
            }

            _logger.LogInformation($"Fetching toss data for TournamentId: {tournamentId}, MatchNo: {matchNo}");

            var tossData = await _context.GetMatchNameTossDataScoring
                .FromSqlRaw("EXEC GetMatchNameTossData_Scoring @TournamentId = {0}, @MatchNo = {1}", tournamentId, matchNo)
                .ToListAsync();

            if (tossData == null || !tossData.Any())
            {
                return Json(new { message = "No toss data found" });
            }

            var result = tossData.Select(t => new { id = t.idTournament, winner = t.HomeTeam, loosing = t.AwayTeam }).ToList();
            Console.WriteLine(result);
            return Json(result);
        }

    }

    @page
    @model ScoringModel
    @{
        ViewData["Title"] = "Home page";
    }
    
    <!DOCTYPE html>
    <html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Match Stats</title>
        <link rel="stylesheet" href="/css/site.css">
    
    </head>
    <body>
    
    <div class="container">
    
            <div class="left-panel">
                <h2>SHILLONG LAJONG FC</h2>
    
                <div class="in-play">
                    <div class="container-undo">
                        <h3>IN PLAY</h3>
                    </div>
                    <ul id="inPlayList">
                        @if (Model.GetMatchStatsScoringList != null && Model.GetMatchStatsScoringList.Any())
                        {
                            foreach (var player in Model.GetMatchStatsScoringList)
                            {
                                <li><button class="lstats-button">@player.HomePlayerName</button></li>
                            }
                        }
                        else
                        {
                            <li>No players in play</li>
                        }
                    </ul>
                </div>
    
                <div class="in-bench">
                    <h3>ON BENCH</h3>
                    <ul id="inBenchList">
                         @if (Model.GetMatchStatsScoringList != null && Model.GetMatchStatsScoringList.Any())
                        {
                            foreach (var player in Model.GetMatchStatsScoringList)
                            {
                                <li><button class="lstats-button">@player.HomePlayerName</button></li>
                            }
                        }
                        else
                        {
                            <li>No players in play</li>
                        }
                    </ul>
                </div>
            </div>
    
        <div class="stats-panel">
          <table>
                    <tr>
                        <th></th>
                        <th>CHENNAI QUICK</th>
                        <th>STAT</th>
                        <th>GUJRAT GIANTS</th>
                        <th></th>
                    </tr>
                   @if (Model.StatMasterList != null && Model.StatMasterList.Any())
                    {
                        @foreach (var stat in Model.StatMasterList)
                        {
                            <tr>
                                <td>00</td>
                                <td>00</td> 
                                <td><button class="stats-button">@stat.Name</button></td> 
                                <td>00</td> 
                                <td>00</td>
                            </tr>
                        }
                    }
                    else
                    {
                        <tr><td colspan="3">No data available</td></tr>
                    }
                </table>
        </div>
    
        <div class="right-panel">
           <h2>CHURCHILL BROTHERS</h2>
                <div class="in-play">
                    <div class="container-undo">
                        <h3>IN PLAY</h3>
                    </div>
                    <ul>
                             @if (Model.GetMatchStatsScoringList != null && Model.GetMatchStatsScoringList.Any())
                        {
                            foreach (var player in Model.GetMatchStatsScoringList)
                            {
                                <li><button class="lstats-button">@player.AwayPlayerName</button></li>
                            }
                        }
                        else
                        {
                            <li>No players in play</li>
                        }
                        </ul>
                </div>
                <div class="in-bench">
                    <h3>ON BENCH</h3>
                    <ul>
                             @if (Model.GetMatchStatsScoringList != null && Model.GetMatchStatsScoringList.Any())
                        {
                            foreach (var player in Model.GetMatchStatsScoringList)
                            {
                                <li><button class="lstats-button">@player.AwayPlayerName</button></li>
                            }
                        }
                        else
                        {
                            <li>No players in play</li>
                        }
                        </ul>
                </div>
        </div>
    
    </div>
    <script>
    
    
    var matchNo = '@ViewBag.MatchNo';
        var tournamentId = '@ViewBag.TournamentId';
        console.log("Match No from View:", matchNo);
        console.log("Tournament ID from View:", tournamentId);
    
    console.log("Fetching with URL:", `/Scoring/GetPlayerStats?matchNo=${matchNo}&tournamentId=${tournamentId}`);
    
    
       fetch(`${window.location.origin}/GetPlayerStats?matchNo=${matchNo}&tournamentId=${tournamentId}`)
            .then(response => {
                if (!response.ok) {
                    throw new Error('Failed to fetch player stats');
                }
                return response.json();
            })
            .then(data => {
                const inPlayList = document.getElementById('inPlayList');
                const inBenchList = document.getElementById('inBenchList');
    
                if (!inPlayList || !inBenchList) {
                    console.error('Error: List elements not found');
                    return;
                }
    
                inPlayList.innerHTML = '';
                inBenchList.innerHTML = '';
    
                if (Array.isArray(data) && data.length > 0) {
                    data.forEach(player => {
                        const listItem = document.createElement('li');
                        listItem.textContent = `Player ID: ${player.PlayerId} - Name: ${player.PlayerName}`;
    
                        if (player.Status === "In Play") {
                            inPlayList.appendChild(listItem);
                        } else if (player.Status === "In Bench") {
                            inBenchList.appendChild(listItem);
                        }
                    });
                } else {
                    console.warn('No player data available or empty list');
                }
            })
            .catch(error => {
                console.error('Error:', error);
        });
    );
    
    </script>
    
    
    </body>
    </html>

    using Microsoft.AspNetCore.Mvc;
using Microsoft.AspNetCore.Mvc.RazorPages;
using Microsoft.EntityFrameworkCore;
using _24IN_Ultimate_KHO_KHO_VS.Data;
using Microsoft.Extensions.Logging;  
using Newtonsoft.Json;

public class ScoringModel : PageModel
{
    private readonly ApplicationDbContext _context;
    private readonly ILogger<ScoringModel> _logger;

    public ScoringModel(ApplicationDbContext context, ILogger<ScoringModel> logger)
    {
        _context = context;  
        _logger = logger;
    }

    public List<StatMaster> StatMasterList { get; set; }
    public List<GetMatchStats_Scoring> GetMatchStatsScoringList {get;set;}


    public async Task OnGetAsync(string tournamentId, string matchNo)
    {
        GetMatchStatsScoringList = await _context.GetMatchStatsScoring
            .FromSqlInterpolated($"EXEC GetMatchStats_Scoring @MatchNo = {matchNo}, @TournamentId = {tournamentId}")
            .ToListAsync();

        if (GetMatchStatsScoringList == null || !GetMatchStatsScoringList.Any())
        {
            _logger.LogWarning($"No player data found for MatchNo {matchNo} and TournamentId {tournamentId}");
        }

        StatMasterList = await _context.StatMaster
            .FromSqlInterpolated($"SELECT idStat, Name FROM StatMaster")
            .ToListAsync();
    }
}


using Microsoft.AspNetCore.Mvc;
using Microsoft.EntityFrameworkCore;
using _24IN_Ultimate_KHO_KHO_VS.Data;
using Newtonsoft.Json;

    
    public class ScoringController : Controller
    {
        private readonly ApplicationDbContext _context;

        public ScoringController(ApplicationDbContext context)
        {
            _context = context;
        }

        public IActionResult Scoring(string tournamentId, string matchNo, string selectedTeam, string choice)
        {
            if (string.IsNullOrEmpty(tournamentId) || string.IsNullOrEmpty(matchNo))
            {
                return BadRequest("Tournament ID and Match No are required.");
            }

            ViewBag.TournamentId = tournamentId;
            ViewBag.MatchNo = matchNo;
            ViewBag.SelectedTeam = selectedTeam;
            ViewBag.Choice = choice;

            var matchData = _context.MatchMaster
                .FirstOrDefault(m => m.idTournament == tournamentId && m.MatchNo == matchNo);

            if (matchData == null)
            {
                return NotFound("No match data found for the given Tournament and Match.");
            }

            return View("Scoring");
        }

    //    public IActionResult Scoring(string tournamentId, string matchNo)
    //     {

          
    //         ViewBag.MatchNo = matchNo; 
    //         ViewBag.TournamentId = tournamentId;

    //         if (string.IsNullOrEmpty(tournamentId) || string.IsNullOrEmpty(matchNo))
    //         {
    //             return BadRequest("Tournament ID and Match No are required.");
    //         }

    //         var matchData = _context.MatchMaster
    //             .Where(m => m.idTournament == tournamentId && m.MatchNo == matchNo)
    //             .FirstOrDefault();

    //         if (matchData == null)
    //         {
    //             return NotFound("No match data found for the given Tournament and Match.");
    //         }

    //         return View("Scoring");
    //     }

        public async Task<IActionResult> GetPlayerStats(string matchNo, string tournamentId)
    {
        // Call the stored procedure to get player stats
        var playerStats = await _context.GetMatchStatsScoring
            .FromSqlInterpolated($"EXEC GetMatchStats_Scoring @MatchNo = {matchNo}, @TournamentId = {tournamentId}")
            .ToListAsync();

        if (!playerStats.Any())
        {
            return NotFound(new { message = "No data found for the given MatchNo" });
        }

        return Json(playerStats);
    }


}


let selectedTeam = null;
let selectedChoice = null;

function getSelectedData() {
if (!selectedTeam) {
    alert('Please select a team.');
    return null;
}

const homeChoice = document.querySelector('input[name="homeChoice"]:checked');
const awayChoice = document.querySelector('input[name="awayChoice"]:checked');

const selectedCheckbox = homeChoice
    ? { team: 'HomeTeam', choice: homeChoice.value }
    : awayChoice
    ? { team: 'AwayTeam', choice: awayChoice.value }
    : null;

if (!selectedCheckbox) {
    alert('Please select Attacking or Defending for the chosen team.');
    return null;
}

let otherTeamChoice='';
let unselectedTeam='';
if(selectedCheckbox.team === 'HomeTeam')
{
    otherTeamChoice=selectedCheckbox.choice === 'Attacking' ? 'Defending' : 'Attacking';
    unselectedTeam='AwayTeam';
}
else if(selectedCheckbox.team === 'AwayTeam')
{
    otherTeamChoice=selectedCheckbox.choice === 'Attacking' ? 'Defending' : 'Attacking';
    unselectedTeam='HomeTeam';
}

return {
    team1: selectedCheckbox.team,
    team2: unselectedTeam,
    choice:selectedCheckbox.choice,
    otherTeamChoice: otherTeamChoice,

};
}

function selectTeam(teamId) {
if (selectedTeam && selectedTeam !== teamId) {
    document.querySelector(`#${selectedTeam}`).classList.remove('selected');
}

selectedTeam = teamId;
document.querySelector(`#${teamId}`).classList.add('selected');
}


document.querySelector('#confirmNavigate').addEventListener('click', function () {
const selectedData = getSelectedData();

if (selectedData) {
    const tournamentId = document.querySelector('#dropdown1').value;
    const matchNo = document.querySelector('#dropdown2').value;

    if (!tournamentId || !matchNo) {
        alert('Please select Tournament and Match.');
        return;
    }

    console.log(`Selected TournamentId: ${tournamentId}, Selected MatchNo: ${matchNo}`);

    const queryString = new URLSearchParams({
        tournamentId: tournamentId,
        matchNo: matchNo,
        team1: selectedData.team1,
        team2: selectedData.team2,
        choice: selectedData.choice,
        otherTeamChoice: selectedData.otherTeamChoice
    }).toString();
    window.location.href = `/dataEnter?${queryString}`;
}
}); 


function fetchTossData(tournamentId, matchNo) {
fetch(`${window.location.origin}/GetTossData?tournamentId=${tournamentId}&matchNo=${matchNo}`)
    .then(response => {
        if (!response.ok) {
            throw new Error(`Error fetching toss data: ${response.statusText}`);
        }
        return response.json();
    })
    .then(data => {
        const homeTeamButton = document.querySelector('#HomeTeam');
        const awayTeamButton = document.querySelector('#AwayTeam');

        if (data && data.length > 0) {
            homeTeamButton.textContent = data[0].HomeTeam || 'No data';
            awayTeamButton.textContent = data[0].AwayTeam || 'No data';

            homeTeamButton.dataset.teamId = 'winner';
            awayTeamButton.dataset.teamId = 'loosing';
        } else {
            homeTeamButton.textContent = 'No data found';
            awayTeamButton.textContent = 'No data found';
        }
    })
    .catch(err => {
        console.error('Error fetching toss data:', err);

        const homeTeamButton = document.querySelector('#HomeTeam');
        const awayTeamButton = document.querySelector('#AwayTeam');
        homeTeamButton.textContent = 'Error loading data';
        awayTeamButton.textContent = 'Error loading data';
    });
}
--------------------------------------------------------------

@page
@model dataEntryModel
@{
    ViewData["Title"] = "Home page";
    var tournamentId = ViewData["TournamentId"] as string;
    var matchNo = ViewData["MatchNo"] as string;
    var matchName = ViewData["MatchName"] as string;
    var playerStats = Model.GetMatchStatsScoringList;
}

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>StartForm</title>
    <link rel="stylesheet" href="/css/site.css">

</head>
<body>

<div class="container-data">
    <div class="box">
      <table class="datatable">
        <thead>
          <tr>
            <th scope="col">S.No</th>
            <th scope="col">Name</th>
            <th scope="col">Batch No</th>
            <th scope="col">Player Status</th>
          </tr>
        </thead>
        <tbody>
           @if (playerStats != null && playerStats.Any())
            {
                int serialNo = 1; // To generate S.No for each player
                foreach (var player in playerStats)
                {
                    <tr>
                        <th scope="row">@serialNo</th>
                        <td>@player.HomePlayerName</td> <!-- Populate player name -->
                        <td>
                            <select class="data-form" id="dropdownBatch" name="BatchNo" required>
                                <option value="" selected>Batch No</option>
                                <option value="1">1</option>
                                <option value="2">2</option>
                                <option value="3">3</option>
                                <option value="4">4</option>
                            </select>
                        </td>
                        <td>
                            <select class="data-form" id="dropdownPStat" name="PlayerStatus" required>
                                <option value="" selected>Player status</option>
                                <option value="InPlay">InPlay</option>
                                <option value="InBench">InBench</option>
                            </select>
                        </td>
                    </tr>
                    serialNo++; // Increment the serial number for the next player
                }
            }
            else
            {
                <tr>
                    <td colspan="4">No player data available</td>
                </tr>
            }
          @* <tr>
            <th scope="row">1</th>
            <td>Mark</td>
            <td>
                      <select class="data-form" id="dropdownBatch" name="BatchNo" required>
                          <option value="" selected>Batch No</option>
                          <option value="batchno">1</option>
                          <option value="batchno">2</option>
                          <option value="batchno">3</option>
                          <option value="batchno">4</option>
                      </select>
            </td>
            <td>
                      <select class="data-form" id="dropdownPStat" name="PlayerStatus" required>
                          <option value="" selected>Player status</option>
                          <option value="playerStatus">InPlay</option>
                          <option value="playerStatus">InBench</option>
                      </select>
            </td>
          </tr> *@
        </tbody>
      </table>
    </div>

              <div class="middle-box">
                <div>
                    <label for="TeamName" class="form-label">Choose Winning Team</label>
                    <select class="form-select" id="TeamName" name="TeamSelection" required>
                        <option value="" selected>Select Team</option>           
                       @foreach (var team in Model.GetMatchStatsScoringList
                        .SelectMany(x => new[] { x.HomeTeamName, x.AwayTeamName })
                        .Distinct())
                          {
                              <option value="@team">@team</option>
                          }
                    </select>
                </div>
                <div>
                    <label for="PlayerStat" class="form-label">Choose Player Stat</label>
                    <select class="form-select" id="PlayerStat" name="PlayerStatSelection" required>
                        <option value="" selected>Select Attack or Defend</option>
                        <option value="Attacking">Attacking</option>
                        <option value="Defending">Defending</option>
                    </select>
                </div>
                <button type="button" class="btn-box" id="updateURL">Save</button>
              </div>
                

    <div class="box">
      <table class="datatable">
        <thead>
          <tr>
            <th scope="col">S.No</th>
            <th scope="col">Name</th>
            <th>Batch No</th>
            <th>Player Status</th>

          </tr>
        </thead>
        <tbody>
          <tr>
            <th scope="row">1</th>
            <td>Mark</td>
            <td>
                      <select class="data-form" id="dropdown1" name="TournamentId" required>
                          <option value="" selected>Batch no</option>
                          <option value="batchno">1</option>
                          <option value="batchno">2</option>
                          <option value="batchno">3</option>
                          <option value="batchno">4</option>
                      </select>
            </td>
            <td>
                      <select class="data-form" id="dropdown1" name="TournamentId" required>
                        <option value="" selected>player status</option>
                        <option value="playerStatus">InPlay</option>
                        <option value="playerStatus">InBench</option>
                      </select>
            </td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>

</body>
</html>


--------------------------------------------------------------// const matchDropdown=document.querySelector('#dropdown1')
// if(matchDropdown){
//   matchDropdown.addEventListener('change', function () {
//     const tournamentId = this.value;
//     const dropdown2=document.querySelector('#dropdown2');

//     if (!tournamentId) {
//         dropdown2.innerHTML = '<option value="" selected>Select a match</option>';
//         return;
//     }

//     fetch(`${window.location.origin}/GetMatches?tournamentId=${tournamentId}`)
//         .then(response => {
//             if (!response.ok) {
//                 throw new Error(`HTTP error! status: ${response.status}`);
//             }
//             return response.json();
//         }) 
//         .then(data => {
//             console.log('Fetched matches:', data); // Inspect response data
//             dropdown2.innerHTML = '<option value="" selected>Select a match</option>'; // Reset dropdown

//             if (data.length > 0) {
//                 data.forEach(match => {
//                     const option = document.createElement('option');
//                     option.value = match.id;
//                     option.textContent = `${match.id} - ${match.name}`;
//                     dropdown2.appendChild(option);


//                 });
//             } else {
//                 const option = document.createElement('option');
//                 option.value = "";
//                 option.textContent = "No matches found";
//                 dropdown2.appendChild(option);
//             }
//         })
//         .catch(err => {
//             console.error('Error fetching matches:', err);
//         });
// });
// }


---------------------------------------js------------------------------
let matchDropdown = document.querySelector('#dropdown1');
if (matchDropdown) {
  matchDropdown.addEventListener('change', function () {
    const tournamentId = this.value;
    const matchDropdown2 = document.querySelector('#dropdown2');

    if (!tournamentId) {
      matchDropdown2.innerHTML = '<option value="" selected>Select a match</option>';
      return;
    }

    fetch(`${window.location.origin}/GetMatches?tournamentId=${tournamentId}`)
      .then(response => {
        if (!response.ok) {
          throw new Error(`HTTP error! status: ${response.status}`);
        }
        return response.json();
      })
      .then(data => {
        console.log('Fetched matches:', data); // Inspect response data
        matchDropdown2.innerHTML = '<option value="" selected>Select a match</option>'; // Reset dropdown

        if (data.length > 0) {
          data.forEach(match => {
            const option = document.createElement('option');
            option.value = match.id;
            option.textContent = `${match.id} - ${match.name}`;
            matchDropdown2.appendChild(option);
          });
        } else {
          const option = document.createElement('option');
          option.value = "";
          option.textContent = "No matches found";
          matchDropdown2.appendChild(option);
        }
      })
      .catch(err => {
        console.error('Error fetching matches:', err);
      });
  });
}



///transfering data tournamentid , matchno, matchname and pass this data to /dataEnter page

const confirmNavigateButton = document.querySelector('#confirmNavigatetodataEnter');
if (confirmNavigateButton) {
  confirmNavigateButton.addEventListener('click', function () {
    let tournamentId = document.querySelector('#dropdown1').value;
    const matchElement = document.querySelector('#dropdown2');
    const matchNo = matchElement.value;
    const matchName = matchElement.options[matchElement.selectedIndex]?.text || ""; // Get the match name (text of the option)

    if (!tournamentId || !matchNo) {
      alert('Please select both a tournament and a match.');
      return;
    }

    const url = `/dataEnter?tournamentId=${encodeURIComponent(tournamentId)}&matchNo=${encodeURIComponent(matchNo)}&matchName=${encodeURIComponent(matchName)}`;
    window.location.href = url;
  });
}


const confirmNavigatetoScoring = document.querySelector('#confirmNavigatetoScoring');
if (confirmNavigateButton) {
  confirmNavigateButton.addEventListener('click', function () {
    // const tournamentId = document.querySelector('#dropdown1').value;
    // const matchElement = document.querySelector('#dropdown2');
    // const matchNo = matchElement.value;
    // const matchName = matchElement.options[matchElement.selectedIndex]?.text || ""; // Get the match name (text of the option)

    // if (!tournamentId || !matchNo) {
    //   alert('Please select both a tournament and a match.');
    //   return;
    // }

    const url = `/Scoring`;
    window.location.href = url;
  });
}


if (confirmNavigateButton) {
  confirmNavigateButton.addEventListener('click', function () {
    const tournamentId = document.querySelector('#dropdown1').value;
    const matchElement = document.querySelector('#dropdown2');
    const matchNo = matchElement.value;
    const matchName = matchElement.options[matchElement.selectedIndex]?.text || ""; // Get the match name (text of the option)

    if (!tournamentId || !matchNo) {
      alert('Please select both a tournament and a match.');
      return;
    }

    const url = `/dataEnter?tournamentId=${encodeURIComponent(tournamentId)}&matchNo=${encodeURIComponent(matchNo)}&matchName=${encodeURIComponent(matchName)}`;
    window.location.href = url;
  });
}

//hidding middle-box
document.addEventListener("DOMContentLoaded", function () {
    const updateButton = document.getElementById("save");
    if (updateButton) {
      updateButton.addEventListener("click", function () {
        const middleBox = document.querySelector(".middle-box");
        if (middleBox) {
          middleBox.style.display = "none"; // Hide the box
        }
      });
    }
  });


  var matchStatsScoringList = new List<MatchStatsScoring>();

    using (var connection = new SqlConnection(_connectionString))
    {
        using (var command = new SqlCommand("GetMatchStats_Scoring", connection))
        {
            command.CommandType = CommandType.StoredProcedure;
            command.Parameters.AddWithValue("@MatchNo", matchNo);
            command.Parameters.AddWithValue("@TournamentId", tournamentId);
    
            connection.Open();
    
            using (var reader = await command.ExecuteReaderAsync())
            {
                while (await reader.ReadAsync())
                {
                    var item = new MatchStatsScoring
                    {
                        // Map fields from the reader to your model
                        Field1 = reader["Field1"].ToString(),
                        Field2 = reader.GetInt32(reader.GetOrdinal("Field2")),
                        // Add other fields as required
                    };
    
                    matchStatsScoringList.Add(item);
                }
            }
        }
    }



    ---------------------------------------------------------------------------a------h
    //         dataEnterScoringListH = dataEnterScoringList
//             .Where(item => item.team_category == "Home")
//             .ToList();

// foreach(var stat in dataEnterScoringListH){
// Console.WriteLine("Home team - ",dataEnterScoringListH);
// }

//         dataEnterScoringListA = dataEnterScoringList
//             .Where(item => item.team_category == "Away")
//             .ToList();

// foreach(var stat in dataEnterScoringListH){
// Console.WriteLine("Away team - ",dataEnterScoringListA);
// }



------------------------------------------------sp-----------------------------------
using (var connection = _context.Database.GetDbConnection())
            {
                await connection.OpenAsync();
                using (var command = connection.CreateCommand())
                {
                    command.CommandText = "EXEC dataEnter_Scoring @MatchNo, @TournamentId";
                    command.Parameters.Add(new SqlParameter("@MatchNo", SqlDbType.NVarChar) { Value = matchNo });
                    command.Parameters.Add(new SqlParameter("@TournamentId", SqlDbType.NVarChar) { Value = tournamentId });


                    using (var reader = await command.ExecuteReaderAsync())
                    {
                        while (await reader.ReadAsync())
                        {
                            Console.WriteLine($"PlayerName: {reader["playername"]}");
                        }
                    }
                }
            }



            dataEnterScoringList = await _context.dataEnterScoring
            .FromSqlInterpolated($"EXEC dataEnter_Scoring @MatchNo = {matchNo}, @TournamentId = {tournamentId}")
            .ToListAsync();

            var dataEnterScoringList = await _context.dataEnterScoring
            .FromSqlRaw("EXEC dataEnter_Scoring @MatchNo = {0}, @TournamentId = {1}", matchNo, tournamentId)
            .ToListAsync();
            foreach(var stat in dataEnterScoringList){
            Console.WriteLine($"Row count: {stat.playername}");
            Console.WriteLine($"Row count: {dataEnterScoringList.Count}");
            }


            ---------------------------------------------------------------------------a------hdataEnterScoringAwayList = await _context.dataEnterScoring
            .FromSqlInterpolated($"EXEC dataEnter_Scoring @MatchNo = {matchNo}, @TournamentId = {tournamentId}")
            .AsNoTracking()    ///this is must for getting all data from SP
            .ToListAsync();

        dataEnterScoringAwayList = dataEnterScoringAwayList
                .Where(item => item.team_category == "Away")
                .ToList();




        if (!dataEnterScoringAwayList.Any())
        {
            Console.WriteLine("No data returned from the stored procedure.");
        }
        else
        {
            foreach (var item in dataEnterScoringAwayList)
            {
                Console.WriteLine($"PlayerName: {item.playername}");
            }
        }

            dataEnterScoringHomeList = await _context.dataEnterScoring
            .FromSqlInterpolated($"EXEC dataEnter_Scoring @MatchNo = {matchNo}, @TournamentId = {tournamentId}")
            .AsNoTracking()    ///this is must for getting all data from SP
            .ToListAsync();

            dataEnterScoringHomeList = dataEnterScoringHomeList
                .Where(item => item.team_category == "Away")
                .ToList();

                
        if (!dataEnterScoringHomeList.Any())
        {
            Console.WriteLine("No data returned from the stored procedure.");
        }
        else
        {
            foreach (var item in dataEnterScoringHomeList)
            {
                Console.WriteLine($"PlayerName: {item.playername}");
            }
        }
